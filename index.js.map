{"version":3,"file":"index.js","sources":["../src/js/fetchEvents.js","../src/templates/card.js","../src/js/pagination.js","../src/js/baseMarkUp.js","../src/js/countriesListMarkUp.js"],"sourcesContent":["export default class EventsApiService {\n  #API_KEY = '3vLlhLsn5MSlQI96Cy78HBPNhef1xnsS';\n  #API_URL = 'https://app.ticketmaster.com/discovery/v2/events.json';\n\n  constructor() {\n    this.page = 0;\n    this.pageSize = 12;\n    this.searchQuery = '';\n  }\n\n  async fetchEvents() {\n    const searchParams = new URLSearchParams({\n      apikey: this.#API_KEY,\n      page: this.page,\n      size: this.pageSize,\n      keyword: this.searchQuery\n    });\n    const url = `${this.#API_URL}?${searchParams}&classificationName=music`;\n\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch events');\n    }\n\n    return response.json();\n  }\n}\n\n// fetch('https://app.ticketmaster.com/discovery/v2/events.json?apikey=3vLlhLsn5MSlQI96Cy78HBPNhef1xnsS')\n","export default function cardMarkUp(events) {\n  const markUp = events.map(event => {\n    const imgUrl = event.images[0]?.url || '';\n    const artist = event.name || 'No name available';\n    const date = event.dates.start.localDate || 'Unknown date';\n    const location = event._embedded?.venues[0].name || 'Unknown location';\n    const eventUrl = event.url || '#';\n\n    return `\n        <li class=\"cards__item\">\n                <img src=\"${imgUrl}\" alt=\"${artist}\" class=\"cards__item__img\">\n                <h2 class=\"cards__item__title\">\n                    ${artist}\n                </h2>\n                <p class=\"cards__item__date\">${date}</p>\n                <a href=\"${eventUrl}\" class=\"cards__item__location__link\">\n                    <svg class=\"location__item__icon\">\n                        <use href=\"/img/icons/sprite.svg#icon-location\"> </use>\n                    </svg>\n\n                   ${location} </a>\n            </li>\n      `;\n  });\n\n  return markUp.join('');\n}\n","export function renderPagination(totalPages, currentPage, onPageClick) {\n    const paginationList = document.querySelector('.pagination__list');\n\n    paginationList.innerHTML = '';\n\n    const paginationBtns = getPaginationBtns(totalPages, currentPage);\n\n\n    const buttonsMarkUp = paginationBtns.map(page => {\n        if (page === '...') {\n            return `<li class=\"pagination__list__item\">\n                <span class=\"pagination__dots\">...</span>\n            </li>`;\n        }\n\n        return ` <li class=\"pagination__list__item\">\n                <button class=\"pagination__list__button ${page === currentPage ? 'active' : ''}\" data-page=${page}>${page+1}</button>\n            </li>`\n    }).join('');\n\n    paginationList.insertAdjacentHTML('beforeend', buttonsMarkUp);\n\n    paginationList.addEventListener('click', onPaginationClick)\n\n    function onPaginationClick(e) {\n        if(e.target.tagName !== 'BUTTON') return;\n        const newPage = Number(e.target.dataset.page);\n        if(newPage === currentPage) return;\n        onPageClick(newPage);\n    }\n\n}\n\nfunction getPaginationBtns(totalPages, currentPage) {\n    const buttons = [];\n    const maxVisibleButtons = 5;\n\n    if (totalPages <= maxVisibleButtons) {\n        for (let i = 0; i < totalPages; i++) {\n            buttons.push(i)\n        }\n    } else {\n        if (currentPage > 1) buttons.push(0)\n        if (currentPage > 2) buttons.push('...')\n\n        const start = Math.max(0, currentPage - 1);\n        const end = Math.min(totalPages, currentPage + 2);\n\n        for (let i = start; i < end; i++) {\n            buttons.push(i)\n        }\n\n\n        if (currentPage < totalPages - 3) buttons.push('...')\n        if (currentPage < totalPages - 1) buttons.push(totalPages - 1)\n    }\n\n    return buttons;\n}","import EventsApiService from './fetchEvents';\nimport cardMarkUp from '../templates/card';\nimport { renderPagination } from './pagination';\n// import { createLogger } from 'vite';\n\nconst list = document.querySelector('.cards__list');\nconst paginationList = document.querySelector('.pagination__list');\nconst searchForm = document.getElementById('header__form');\nconst searchInput = document.getElementById('search-input');\n\nconst eventsApiService = new EventsApiService();\n\nrenderEvents();\n\nsearchForm.addEventListener('submit', onSearchFormSubmit)\n\nasync function onSearchFormSubmit(e) {\n  e.preventDefault();\n\n  eventsApiService.searchQuery = searchInput.value.trim();\n  eventsApiService.page = 0;\n  clearEventsList();\n  clearPagination();\n\n  await renderEvents();\n}\n\nexport default async function renderEvents() {\n  try {\n    const data = await eventsApiService.fetchEvents();\n\n    const events = data._embedded?.events || [];\n    const markUp = cardMarkUp(events);\n\n    list.insertAdjacentHTML('beforeend', markUp);\n\n    const totalPages = data.page.totalPages;\n    renderPagination(totalPages, eventsApiService.page, onPageClick)\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n\n\nfunction clearEventsList() {\n  list.innerHTML = '';\n}\n\nfunction onPageClick(newPage) {\n  if (newPage = eventsApiService.page) return;\n  eventsApiService.page = newPage;\n\n  clearEventsList();\n  renderEvents();\n}\n\nfunction clearPagination() {\n  paginationList.innerHTML = '';\n}","import countries from '/js/allCountries.json'\n\nconst countriesList = document.getElementById('header__form__country__select');\nconst countriesListText = document.querySelector('.header__form__country__button-text');\n\nconst countriesListMarkUp = countries.map(country => {\n    return `\n        <option class='header__form__country__option' value=\"${country.en}\">${country.en}</option>\n    `\n}).join('')\n\ncountriesList.insertAdjacentHTML('beforeend', countriesListMarkUp);\n\ncountriesList.addEventListener('change', onCountryListChange);\n\nfunction onCountryListChange(e) {\n    const selectedValue = e.target.value;\n    countriesListText.textContent = selectedValue;\n}\n\n\n"],"names":["EventsApiService","__privateAdd","_API_KEY","_API_URL","searchParams","__privateGet","url","response","cardMarkUp","events","event","imgUrl","_a","artist","date","location","_b","eventUrl","renderPagination","totalPages","currentPage","onPageClick","paginationList","buttonsMarkUp","getPaginationBtns","page","onPaginationClick","e","newPage","buttons","i","start","end","list","searchForm","searchInput","eventsApiService","renderEvents","onSearchFormSubmit","clearEventsList","clearPagination","data","markUp","error","countriesList","countriesListText","countriesListMarkUp","countries","country","onCountryListChange","selectedValue"],"mappings":"+8BAAe,MAAMA,CAAiB,CAIpC,aAAc,CAHdC,EAAA,KAAAC,EAAW,oCACXD,EAAA,KAAAE,EAAW,yDAGT,KAAK,KAAO,EACZ,KAAK,SAAW,GAChB,KAAK,YAAc,EACpB,CAED,MAAM,aAAc,CAClB,MAAMC,EAAe,IAAI,gBAAgB,CACvC,OAAQC,EAAA,KAAKH,GACb,KAAM,KAAK,KACX,KAAM,KAAK,SACX,QAAS,KAAK,WACpB,CAAK,EACKI,EAAM,GAAGD,EAAA,KAAKF,EAAQ,IAAIC,CAAY,4BAEtCG,EAAW,MAAM,MAAMD,CAAG,EAEhC,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,wBAAwB,EAG1C,OAAOA,EAAS,MACjB,CACH,CA1BEL,EAAA,YACAC,EAAA,YCFa,SAASK,EAAWC,EAAQ,CAyBzC,OAxBeA,EAAO,IAAIC,GAAS,SACjC,MAAMC,IAASC,EAAAF,EAAM,OAAO,CAAC,IAAd,YAAAE,EAAiB,MAAO,GACjCC,EAASH,EAAM,MAAQ,oBACvBI,EAAOJ,EAAM,MAAM,MAAM,WAAa,eACtCK,IAAWC,EAAAN,EAAM,YAAN,YAAAM,EAAiB,OAAO,GAAG,OAAQ,mBAC9CC,EAAWP,EAAM,KAAO,IAE9B,MAAO;AAAA;AAAA,4BAEiBC,CAAM,UAAUE,CAAM;AAAA;AAAA,sBAE5BA,CAAM;AAAA;AAAA,+CAEmBC,CAAI;AAAA,2BACxBG,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,qBAKdF,CAAQ;AAAA;AAAA,OAG7B,CAAG,EAEa,KAAK,EAAE,CACvB,CC1BO,SAASG,EAAiBC,EAAYC,EAAaC,EAAa,CACnE,MAAMC,EAAiB,SAAS,cAAc,mBAAmB,EAEjEA,EAAe,UAAY,GAK3B,MAAMC,EAHiBC,EAAkBL,EAAYC,CAAW,EAG3B,IAAIK,GACjCA,IAAS,MACF;AAAA;AAAA,mBAKJ;AAAA,0DAC2CA,IAASL,EAAc,SAAW,EAAE,eAAeK,CAAI,IAAIA,EAAK,CAAC;AAAA,kBAEtH,EAAE,KAAK,EAAE,EAEVH,EAAe,mBAAmB,YAAaC,CAAa,EAE5DD,EAAe,iBAAiB,QAASI,CAAiB,EAE1D,SAASA,EAAkBC,EAAG,CAC1B,GAAGA,EAAE,OAAO,UAAY,SAAU,OAClC,MAAMC,EAAU,OAAOD,EAAE,OAAO,QAAQ,IAAI,EACzCC,IAAYR,GACfC,EAAYO,CAAO,CACtB,CAEL,CAEA,SAASJ,EAAkBL,EAAYC,EAAa,CAChD,MAAMS,EAAU,CAAA,EAGhB,GAAIV,GAAc,EACd,QAASW,EAAI,EAAGA,EAAIX,EAAYW,IAC5BD,EAAQ,KAAKC,CAAC,MAEf,CACCV,EAAc,GAAGS,EAAQ,KAAK,CAAC,EAC/BT,EAAc,GAAGS,EAAQ,KAAK,KAAK,EAEvC,MAAME,EAAQ,KAAK,IAAI,EAAGX,EAAc,CAAC,EACnCY,EAAM,KAAK,IAAIb,EAAYC,EAAc,CAAC,EAEhD,QAASU,EAAIC,EAAOD,EAAIE,EAAKF,IACzBD,EAAQ,KAAKC,CAAC,EAIdV,EAAcD,EAAa,GAAGU,EAAQ,KAAK,KAAK,EAChDT,EAAcD,EAAa,GAAGU,EAAQ,KAAKV,EAAa,CAAC,CAChE,CAED,OAAOU,CACX,CCrDA,MAAMI,EAAO,SAAS,cAAc,cAAc,EAC5CX,EAAiB,SAAS,cAAc,mBAAmB,EAC3DY,EAAa,SAAS,eAAe,cAAc,EACnDC,EAAc,SAAS,eAAe,cAAc,EAEpDC,EAAmB,IAAIpC,EAE7BqC,IAEAH,EAAW,iBAAiB,SAAUI,CAAkB,EAExD,eAAeA,EAAmBX,EAAG,CACnCA,EAAE,eAAc,EAEhBS,EAAiB,YAAcD,EAAY,MAAM,KAAI,EACrDC,EAAiB,KAAO,EACxBG,IACAC,IAEA,MAAMH,EAAY,CACpB,CAEe,eAAeA,GAAe,OAC3C,GAAI,CACF,MAAMI,EAAO,MAAML,EAAiB,cAE9B3B,IAASG,EAAA6B,EAAK,YAAL,YAAA7B,EAAgB,SAAU,CAAA,EACnC8B,EAASlC,EAAWC,CAAM,EAEhCwB,EAAK,mBAAmB,YAAaS,CAAM,EAE3C,MAAMvB,EAAasB,EAAK,KAAK,WAC7BvB,EAAiBC,EAAYiB,EAAiB,KAAMf,CAAW,CAChE,OAAQsB,EAAO,CACd,QAAQ,MAAMA,CAAK,CACpB,CACH,CAIA,SAASJ,GAAkB,CACzBN,EAAK,UAAY,EACnB,CAEA,SAASZ,EAAYO,EAAS,EACxBA,EAAUQ,EAAiB,QAC/BA,EAAiB,KAAOR,EAExBW,IACAF,IACF,CAEA,SAASG,GAAkB,CACzBlB,EAAe,UAAY,EAC7B,+sqGCzDMsB,EAAgB,SAAS,eAAe,+BAA+B,EACvEC,EAAoB,SAAS,cAAc,qCAAqC,EAEhFC,EAAsBC,EAAU,IAAIC,GAC/B;AAAA,+DACoDA,EAAQ,EAAE,KAAKA,EAAQ,EAAE;AAAA,KAEvF,EAAE,KAAK,EAAE,EAEVJ,EAAc,mBAAmB,YAAaE,CAAmB,EAEjEF,EAAc,iBAAiB,SAAUK,CAAmB,EAE5D,SAASA,EAAoBtB,EAAG,CAC5B,MAAMuB,EAAgBvB,EAAE,OAAO,MAC/BkB,EAAkB,YAAcK,CACpC"}